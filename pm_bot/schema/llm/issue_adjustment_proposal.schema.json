{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "pm_bot/schema/llm/issue_adjustment_proposal.schema.json",
  "title": "issue_adjustment_proposal capability output",
  "type": "object",
  "required": ["schema_version", "bundle"],
  "additionalProperties": false,
  "properties": {
    "schema_version": { "type": "string", "enum": ["changeset_bundle_proposal/v1"] },
    "bundle": {
      "type": "object",
      "required": ["bundle_id", "requires_human_approval", "changesets"],
      "additionalProperties": false,
      "properties": {
        "bundle_id": { "type": "string" },
        "requires_human_approval": { "type": "boolean", "const": true },
        "changesets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["operation", "repo", "target_ref", "idempotency_key", "payload"],
            "additionalProperties": false,
            "properties": {
              "operation": { "type": "string" },
              "repo": { "type": "string" },
              "target_ref": { "type": "string" },
              "idempotency_key": { "type": "string" },
              "payload": { "type": "object" }
            }
          }
        }
      }
    }
  }
}
